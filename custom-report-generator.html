<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Custom Report Generator | Crime Data Analysis</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background: #18181b; color: #fff; min-height: 100vh; }
    .container { max-width: 540px; margin: 48px auto; background: #23232a; border-radius: 18px; box-shadow: 0 4px 24px #0002; padding: 40px 32px 32px 32px; }
    h2 { text-align: center; color: #6366f1; font-size: 2rem; font-weight: 700; margin-bottom: 28px; letter-spacing: 1px; }
    label { font-weight: 600; color: #818cf8; margin-top: 18px; margin-bottom: 6px; display: block; font-size: 1.05rem; }
    select, input { width: 100%; padding: 10px 14px; border-radius: 8px; border: 2px solid #e5e7eb; font-size: 1rem; background: #1e293b; margin-bottom: 8px; color: #fff; transition: border 0.2s; }
    select:focus, input:focus { border-color: #6366f1; outline: none; background: #23232a; }
    .btn { background: linear-gradient(90deg, #6366f1 0%, #9333ea 100%); color: #fff; padding: 12px 0; border-radius: 10px; font-weight: 700; font-size: 1.1rem; width: 100%; box-shadow: 0 2px 8px #6366f144; cursor: pointer; transition: background 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px; }
    .btn:hover { background: linear-gradient(90deg, #4338ca 0%, #7c3aed 100%); }
    .result { margin-top: 28px; padding: 18px; background: #312e81; border-radius: 10px; text-align: center; font-size: 1.15em; color: #c7d2fe; font-weight: 600; box-shadow: 0 2px 8px #6366f144; letter-spacing: 0.5px; }
    .back-btn { position: fixed; top: 18px; right: 18px; z-index: 1000; }
    .back-btn button { padding: 6px 14px 6px 10px; font-size: 0.95em; border-radius: 30px; box-shadow: 0 2px 8px #ef444444; background: #ef4444; color: #fff; border: none; font-weight: bold; display: flex; align-items: center; gap: 6px; cursor: pointer; }
    .back-btn button:hover { background: #dc2626; }
    .back-icon { font-size: 1em; }
    @media (max-width: 600px) {
      .container { padding: 18px 6px 18px 6px; }
      h2 { font-size: 1.2rem; }
      .back-btn { top: 8px; right: 8px; }
    }
  </style>
</head>
<body>
  <div class="back-btn">
    <button onclick="goBack()" title="Back">
      <span class="back-icon"><i class='bx bx-arrow-back'></i></span> Back
    </button>
  </div>
  <div class="container">
    <h2><i class='bx bx-filter'></i> Custom Report Generator</h2>
    <form id="compareForm" class="w-full flex flex-col gap-3 mt-2">
      <label class="text-indigo-400 font-semibold">Division 1</label>
      <select id="division1">
        <option value="">Select Division</option>
      </select>
      <label class="text-indigo-400 font-semibold">Division 2</label>
      <select id="division2">
        <option value="">Select Division</option>
      </select>
      <button type="submit" class="btn mt-2"><i class='bx bx-bar-chart'></i> Compare</button>
    </form>
    <div id="compareResult" class="result"></div>
  </div>
  <script>
    function goBack() {
      if (window.history.length > 1) {
        history.back();
      } else {
        window.location.href = "reports.html";
      }
    }

    // All divisions of Bangladesh
    const allDivisions = [
      "Dhaka", "Chattogram", "Rajshahi", "Khulna", "Barisal",
      "Sylhet", "Rangpur", "Mymensingh"
    ];

    // Get crime data from localStorage (used in analytics)
    let crimes = [];
    try { crimes = JSON.parse(localStorage.getItem('crimes') || '[]'); } catch { crimes = []; }

    // Populate division dropdowns with all divisions
    const division1 = document.getElementById('division1');
    const division2 = document.getElementById('division2');
    allDivisions.forEach(div => {
      const opt1 = document.createElement('option');
      opt1.value = opt1.textContent = div;
      division1.appendChild(opt1);
      const opt2 = document.createElement('option');
      opt2.value = opt2.textContent = div;
      division2.appendChild(opt2);
    });

    document.getElementById('compareForm').onsubmit = function(e) {
      e.preventDefault();
      const div1 = division1.value;
      const div2 = division2.value;
      const resultDiv = document.getElementById('compareResult');
      if (!div1 || !div2 || div1 === div2) {
        resultDiv.innerHTML = "<span class='text-red-400 font-bold'>Please select two different divisions.</span>";
        return;
      }
      // Count crimes for each division from analyze data
      const count1 = crimes.filter(c => c.division === div1).length;
      const count2 = crimes.filter(c => c.division === div2).length;
      resultDiv.innerHTML = `
        <div>
          <h3 class="text-lg font-bold text-indigo-300 mb-2">Comparison Result</h3>
          <table class="w-full text-center mb-2">
            <tr>
              <th class="text-indigo-200">Division</th>
              <th class="text-indigo-200">Crime Count</th>
            </tr>
            <tr>
              <td>${div1}</td>
              <td>${count1}</td>
            </tr>
            <tr>
              <td>${div2}</td>
              <td>${count2}</td>
            </tr>
          </table>
          <div class="text-indigo-200 font-semibold">
            ${count1 > count2 ? `${div1} has more crimes.` : count1 < count2 ? `${div2} has more crimes.` : `Both divisions have equal crimes.`}
          </div>
        </div>
      `;
    };
  </script>
</body>
</html>